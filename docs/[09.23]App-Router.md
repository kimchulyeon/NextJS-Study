# 09.23

# <div style="background-color: yellow;">App Router</div>

> [νμ΄μ§€ λΌμ°ν„°μ™€μ μ°¨μ΄]<br/>
>
> - λ°μ΄ν„° νμΉ­ λ°©μ‹ λ³€κ²½
> - λ μ΄μ•„μ›ƒ μ„¤μ • λ°©μ‹ λ³€κ²½
> - νμ΄μ§€ λΌμ°ν… μ„¤μ • λ°©μ‹ λ³€κ²½
> - λ¦¬μ•΅νΈ 18 (μ„λ²„μ»΄ν¬λ„νΈ, μ¤νΈλ¦¬λ° μ‚¬μ© κ°€λ¥)
>
> [νμ΄μ§€ λΌμ°ν„° κ°™μ€ κ²ƒ]<br/>
>
> - λ„¤λΉ„κ²μ΄ν…
> - ν”„λ¦¬νμΉ­
> - μ‚¬μ „λ λ”λ§

## π€ Installation

```terminal
$ npx create-next-app@rc [project-name] // μ¶μ‹ ν›„λ³΄ λ²„μ „ (15)
$ npx create-next-app@latest [project-name] // μ •μ‹ μ¶μ‹ λ²„μ „

typescrpt
eslint
tailwindCSS
/src
App Router
Turbopack (No)
import alias (No)
```

## π€ Folder Structure

### /src/app

- page.tsx κ°€ νμ΄μ§€ μ—­ν• μ„ ν•λ” μ»΄ν¬λ„νΈ
- layout.tsx κ°€ λ μ΄μ•„μ›ƒ μ—­ν• μ„ ν•λ” μ»΄ν¬λ„νΈ

## π€ νμ΄μ§€ λΌμ°ν… μ„¤μ •

> /app ν΄λ” κΈ°λ° <br/>
> "/search" κ²½λ΅λ” /search ν΄λ” μ•μ— page.tsx <br/>
> "/search/:id" κ²½λ΅λ” /search ν΄λ” μ•μ— /[id] ν΄λ” μ•μ— page.tsx

### "/search" νμ΄μ§€ <br/>

| π“ app-router NextJSμ—μ„ URL Paramsλ‚ Query Stringμ€ μ»΄ν¬λ„νΈμ propsμ— λ‹΄κ²¨μλ‹¤. ( params, searchParams )

```tsx
export default function Page({
  searchParams,
}: {
  searchParams: { q?: string };
}) {
  return <div>Search νμ΄μ§€ : {searchParams.q}</div>;
}
```

### "/book/1", "/book/2", "/book/3" νμ΄μ§€ ("/book/:id") <br/>

```tsx
export default function Page({
  params,
}: {
  params: { id: string | string[] };
}) {
  return <div>Book [id] νμ΄μ§€ : params.id</div>;
}
```

### "/book/1/2", "/book/100/200" νμ΄μ§€ (catch all segement) <br/>

| /src/app/book/[...id]

```tsx
export default function Page({
  params,
}: {
  params: { id: string | string[] };
}) {
  return <div></div>;
}
```

### "/book", "/book/100/200" νμ΄μ§€ (optional catch all segement) <br/>

| /src/app/book/[[...id]]

```tsx
export default function Page({
  params,
}: {
  params: { id: string | string[] };
}) {
  return <div></div>;
}
```

## π€ λ μ΄μ•„μ›ƒ μ„¤μ •

> [ "/search"λ΅ μ‹μ‘ν•λ” λ¨λ“  νμ΄μ§€μ λ μ΄μ•„μ›ƒ ] <br/>
> /search ν΄λ” μ•μ— layout.tsx μƒμ„±

## π€ μ¤‘μ²© λ μ΄μ•„μ›ƒ

> [ /search ν΄λ” μ•μ— layout.tsx κ·Έλ¦¬κ³  /search ν΄λ” μ•μ— /setting ν΄λ” μ•μ— layout.tsx ] <br/>
> /search ν΄λ”μ layout.tsxμ™€ /setting ν΄λ” μ•μ— layout.tsx λ μ΄μ•„μ›ƒ 2κ°κ°€ μ¤‘μ²©λμ„ /setting ν΄λ” μ• page.tsxμ— μ μ©λλ‹¤.

## π€ λ£¨νΈ λ μ΄μ•„μ›ƒ

> /src/app ν΄λ”μ— layout.tsx

```tsx
import type { Metadata } from "next";
import localFont from "next/font/local";
import "./global.css";

const geistSans = localFont({
  src: "./fonts/GeistVF.woff",
  variable: "--font-geist-sans",
});
const geistMono = localFont({
  src: "./font/GeistMonoVF.woff",
  variable: "--font-geist-mono",
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{ children: React.ReactNode }>) {
  return (
    <html lang="en">
      <body className={`${geistSans.variable} ${geistMono.variable}`}>
        {children}
      </body>
    </html>
  );
}
```

## π€ νΉμ • νμ΄μ§€μ—λ§ μ μ©λλ” κ³µν†µ λ μ΄μ•„μ›ƒ : Route Group

| (μ†κ΄„νΈλ΅ κ°μ‹Ό ν΄λ”) κ²½λ΅μ— μν–¥μ„ μ£Όμ§€ μ•λ” ν΄λ”

> /src/app/(with-searchbar) <br/>
> π“ μ†κ΄„νΈ ν΄λ” μ•μ— layout.tsxλ¥Ό λ§λ“¤λ©΄ ν΄λ” μ•μ μ»΄ν¬λ„νΈλ“¤μ λ μ΄μ•„μ›ƒμ„ μ„¤μ •ν•λ‹¤.

<br/><br/><br/>

# <div style="background-color: yellow;">μ„λ²„ μ»΄ν¬λ„νΈ</div>

> μ„λ²„ μΈ΅μ—μ„λ§ μ‹¤ν–‰λλ” μ»΄ν¬λ„νΈ ( λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰ X )

## π“ NextJS λ λ”λ§ κ³Όμ •

1. μ‚¬μ©μκ°€ νΉμ • νμ΄μ§€μ— μ ‘κ·Όν•λ©΄, λΈλΌμ°μ €μ—μ„ ν•΄λ‹Ή νμ΄μ§€λ΅ μ”μ²­μ„ λ³΄λ‚Έλ‹¤.
2. NextJS μ„λ²„κ°€ μ”μ²­μ„ λ°›κ³  ν•΄λ‹Ή νμ΄μ§€λ¥Ό μ„λ²„μ—μ„ λ λ”λ§
3. getServerSideProps ν•¨μλ¥Ό μ‹¤ν–‰(next13)ν•΄μ„ λ°μ΄ν„°λ¥Ό νμΉ­ν•κ±°λ‚ μΈμ¦ λ΅μ§μ„ μ²λ¦¬ν•κ³  νμ΄μ§€ μ»΄ν¬λ„νΈλ΅ λ°μ΄ν„°λ¥Ό μ „λ‹¬
4. νμ΄μ§€ μ»΄ν¬λ„νΈλ¥Ό μ„λ²„μ—μ„ λ λ”λ§ν•λ‹¤. ( React μ»΄ν¬λ„νΈκ°€ HTML λ³€ν™λ¨ )
5. μƒμ„±λ HTMLμ΄ λΈλΌμ°μ €λ΅ μ „μ†΅λλ‹¤.
6. HTMLμ„ λΈλΌμ°μ €μ— λ λ”λ§ν•κ³  Javascript μ½”λ“λ¥Ό λ‹¤μ΄λ΅λ“ν•μ—¬ κΈ°μ΅΄ HTMLκ³Ό μ—°κ²°ν•λ” Hydrationμ„ μ§„ν–‰
   π“ Hydration κ³Όμ •μ—μ„ λ‹¤μ΄λ΅λ“ λλ” Javascript μ½”λ“ μ¤‘μ— μΈν„°λ ‰μ…μ΄ ν•„μ”μ—†λ” μ •μ  μ»΄ν¬λ„νΈλ” μ„λ²„μ—μ„ HTMLλ΅ λ³€ν™λ§ ν•λ©΄ λλ”λ° λ¶ν•„μ”ν•κ² λ‹¤μ΄λ΅λ“ λλ‹¤. ( μ„λ²„ μ»΄ν¬λ„νΈλ΅ ν•΄κ²° )

1οΈβƒ£ μ„λ²„ μ»΄ν¬λ„νΈ : μ„λ²„ μΈ΅μ—μ„ μ‚¬μ „ λ λ”λ§μ„ μ§„ν–‰ν•  λ• ν•λ²λ§ μ‹¤ν–‰ <br/>
2οΈβƒ£ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ : μ‚¬μ „ λ λ”λ§μ„ μ§„ν–‰ν•  λ• ν•λ², Hydrationμ„ μ§„ν–‰ν•  λ• ν•λ² μ΄ 2λ² μ‹¤ν–‰ <br/>
β… νμ΄μ§€ λ€λ¶€λ¶„μ„ μ„λ²„ μ»΄ν¬λ„νΈλ΅ κµ¬μ„±ν•κ³  κΌ­ ν•„μ”ν• κ²½μ°μ— ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό μ‚¬μ©ν•  κ²ƒμ„ κ¶μ¥

### μ„λ²„ μ»΄ν¬λ„νΈ

> app-routerμ—μ„λ” κΈ°λ³Έμ μΌλ΅ μ»΄ν¬λ„νΈκ°€ μ„λ²„ μ»΄ν¬λ„νΈλ΅ μƒμ„±λλ―€λ΅ λ”°λ΅ μ„¤μ •μ΄ ν•„μ”ν•μ§„ μ•λ‹¤.

```tsx
export default function Home() {
  // β… κΈ°λ³Έμ μΌλ΅ μ„λ²„ μ»΄ν¬λ„νΈλ΅ μƒμ„±λκΈ° λ•λ¬Έμ— λ³΄μ•μ μΈ μ‘μ—…μ΄λ‚ λ°μ΄ν„° νμΉ­ μ‘μ—…μ„ ν•΄λ„ λλ‹¤. (λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰ X)
  const SECRET_KEY = "AKDFJEJ123DK";

  // β μ„λ²„ μ»΄ν¬λ„νΈμ΄κΈ° λ•λ¬Έμ— λΈλΌμ°μ € μ‹¤ν–‰λμ–΄μ•Ό ν•λ” κΈ°λ¥λ“¤μ€ μ‚¬μ©ν•  μ μ—†λ‹¤. ( λ¦¬μ•΅νΈ Hooks )
  useEffect(() => {
    console.log("μ„λ²„ μ»΄ν¬λ„νΈμ—¬μ„ μ—λ¬κ°€ λ°μƒν•©λ‹λ‹¤.");
  }, []);

  return (
    <>
      <div>μΈλ±μ¤ νμ΄μ§€</div>
    </>
  );
}
```

### ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ ('use client')

> μƒνΈ μ‘μ©μ΄ μμ–΄μ•Όν•λ©΄ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ§λ“¤λ©΄ λλ‹¤.

```tsx
"use client";

export default function Home() {
  useEffect(() => {
    // π“ μ‚¬μ „ λ λ”λ§ μ‹μ— 1λ², Hydration μ‹μ— λ 1λ² μ‹¤ν–‰λμ„ μ΄ 2λ² μ½μ†”μ΄ μ°νλ‹¤.
    console.log(
      "use clientλ¥Ό μ‚¬μ©ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ§λ“¤μ–΄μ„ λΈλΌμ°μ € μ½μ†”μ΄ μ°νλ‹¤."
    );
  }, []);

  return (
    <>
      <div>μΈλ±μ¤ νμ΄μ§€</div>
    </>
  );
}
```

### μƒνΈ μ‘μ© μ •λ¦¬

- λ¦¬μ¤νΈ νμ΄μ§€λ” μ„λ²„ μ»΄ν¬λ„νΈ ( λ¦¬μ¤νΈ ν΄λ¦­ νμ΄μ§€ μ΄λ™μ€ HTML κ³ μ μ κΈ°λ¥μ΄μ—¬μ„ μƒνΈ μ‘μ©μ΄ μ•„λ‹λ‹¤. )
- κ²€μƒ‰ μΈν’‹ μ»΄ν¬λ„νΈλ” ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ ( μ‹¤μ‹κ°„μΌλ΅ μ…λ ¥ν•λ” κ°’μΌλ΅ μƒνƒκ°’μ„ μ—…λ°μ΄νΈ )

π“ μ„λ²„ μ»΄ν¬λ„νΈ: μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό λ λ”λ§ν•κ±°λ‚, λΈλΌμ°μ €μ—μ„ μλ°”μ¤ν¬λ¦½νΈ μ‹¤ν–‰μ΄ ν•„μ” μ—†λ” κ²½μ°μ— μ‚¬μ© <br/><br/>
π“ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ:

- μ‚¬μ©μ μƒνΈμ‘μ©(ν΄λ¦­, μ…λ ¥ λ“±)μ„ μ²λ¦¬ν•κ±°λ‚, μƒνƒ κ΄€λ¦¬κ°€ ν•„μ”ν• κ²½μ° <br/>
- useRouterμ™€ κ°™μ΄ ν΄λΌμ΄μ–ΈνΈ μΈ΅ λ™μ‘μ΄ ν•„μ”ν• APIλ¥Ό μ‚¬μ©ν•  λ•.

### μ„λ²„ μ»΄ν¬λ„νΈ μ£Όμμ‚¬ν•­

- μ„λ²„ μ»΄ν¬λ„νΈμ—λ” λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λ  μ½”λ“κ°€ ν¬ν•¨λλ©΄ μ•λλ‹¤.

```tsx
// μ„λ²„ μ»΄ν¬λ„νΈ

// β λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λλ” κΈ°λ¥ λΌμ΄λΈλ¬λ¦¬
import someLibrary from 'someLibrary'

export default function Page() {
  // β ν›…
  const [state, setState] = useState()

  // β ν›…
  useEffect(() => {}, [])

  return (
    <>
      {/* β μ΄λ²¤νΈ ν•Έλ“¤λ¬ */}
      <button onClick={() => {...}}>Button</button>
    </>
  )
}
```

- ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” ν΄λΌμ΄μ–ΈνΈμ—μ„λ§ μ‹¤ν–‰λμ§€ μ•λ”λ‹¤. ( μ‚¬μ „ λ λ”λ§ μ‹μ— μ„λ²„μ—μ„ ν•λ² μ‹¤ν–‰λκ³  λ λ”λ§ ν›„ λΈλΌμ°μ €μ—μ„ ν•μ΄λ“λ μ΄μ…μ„ μ„ν•΄ ν•λ² λ” μ‹¤ν–‰λλ‹¤ )
- ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—μ„ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό import ν•  μ μ—†λ‹¤.
  > μ„λ²„ μ»΄ν¬λ„νΈλ” JS Bundleμ— ν¬ν•¨λμ§€ μ•μ•„μ„ λΈλΌμ°μ €μ— μ „λ‹¬ μ΅°μ°¨ λμ§€ μ•λ”λ‹¤.

```tsx
"use client";

import SomeServerComponent from "./some-server-component.tsx";

export default function SomeClientComponent() {
  return (
    <>
      {/* β 'use client' ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—μ„ μ„λ²„ μ»΄ν¬λ„νΈ μ‚¬μ©  */}
      {/* ( μλ™μΌλ΅ μ„λ²„μ»΄ν¬λ„νΈλ¥Ό ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ³€ν™ ) */}
      <SomeServerComponent />
    </>
  );
}
```

> ν•΄κ²°μ±… ( ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό importν•μ§€λ§κ³  children propsλ΅ λ°›κΈ° )

```tsx
<SomeClientComponent>
  {/* ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ³€ν™μ΄ λμ§€ μ•μ */}
  <SomeServerComponent />
</SomeClientComponent>
```

- μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—κ² μ§λ ¬ν™”λμ§€ μ•λ” Propsλ” μ „λ‹¬ λ¶κ°€ν•λ‹¤.

> π“ μ§λ ¬ν™”λ€? κ°μ²΄, λ°°μ—΄ κ°™μ€ λ³µμ΅ν• κµ¬μ΅°μ λ°μ΄ν„°λ¥Ό λ„¤νΈμ›ν¬ μƒμΌλ΅ μ „μ†΅ν•κΈ° μ„ν•΄ λ‹¨μν• ν•νƒμΈ λ¬Έμμ—΄μ΄λ‚ Byteλ΅ λ³€ν™ν•λ” κ²ƒ <br/>
> π“ ν•¨μλ” μ§λ ¬ν™”κ°€ λ¶κ°€λ¥ν•λ‹¤. ( ν•¨μλ” μ„λ²„μ»΄ν¬λ„νΈμ—μ„ ν΄λΌμ΄μ–ΈνΈμ»΄ν¬λ„νΈμ—κ² propsλ΅ μ „λ‹¬μ΄ μ•λλ‹¤. )

| μ„λ²„ μ»΄ν¬λ„νΈλ” RSC Payloadλ΅ μ „λ‹¬ λ°›κ³  ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” JS Bundleλ΅ μ „λ‹¬ λ°›λ”λ‹¤.

## π€ λ„¤λΉ„κ²μ΄μ…κ³Ό ν”„λ¦¬νμΉ­

> νμ΄μ§€ μ”μ²­ ν›„ λΈλΌμ°μ €λ΅ JS Bundleμ΄ μ „λ‹¬λ  λ• μ„λ²„ μ»΄ν¬λ„νΈ μ‹¤ν–‰ κ²°κ³ΌμΈ RSC Payloadλ„ κ°™μ΄ μ „λ‹¬λλ‹¤. <br/>
> ν”„λ¦¬νμΉ­μ€ κ°λ°ν™κ²½μ—μ„ ν™•μΈ μ•λ¨ ( npm run build + start ) <br/>

```tsx
import useRouter from "next/navigation"; // πΆ
import useRouter from "next/router"; // β page router λ°©μ‹μ useRouter
```

> μΏΌλ¦¬μ¤νΈλ§μ΄λ‚ λ‹¤μ΄λ‚λ―Ή URL Path, URL Pathλ¥Ό μ‚¬μ©ν•λ” μ»΄ν¬λ„νΈλ” λ―Έλ¦¬ ν”„λ¦¬νμΉ­ λμ§€ μ•λ”λ‹¤.
