# 09.20

## <div style="background-color: yellow;">SSG ì •ì  ì‚¬ì´íŠ¸ ìƒì„±</div>

> ë¹Œë“œ íƒ€ì„ì— ë¯¸ë¦¬ í˜ì´ì§€ë¥¼ ì‚¬ì „ ë Œë”ë§<br/>
> ğŸ”´ ë§¤ë²ˆ ë˜‘ê°™ì€ í˜ì´ì§€ë§Œ ì‘ë‹µí•¨, ìµœì‹  ë°ì´í„° ë°˜ì˜ ì•ˆë¨

### ì •ì  ê²½ë¡œì— ì ìš© getStaticProps | InferGetStaticPropsType

> ğŸ“Œ ê°œë°œ ëª¨ë“œì—ì„œëŠ” SSG ë°©ì‹ ì‘ë™ì„ í™•ì¸í•˜ê¸° ì–´ë µë‹¤. buildí•´ì„œ í™•ì¸

```tsx
// SSG ( SSRì˜ getServerSideProps )
export const getStaticProps = async () => {
  const [allBooks, recommendBooks] = await Promise.all([
    fetchBooks(),
    fetchRecommendBooks(),
  ]);

  return {
    props: { allBooks, recommendBooks },
  };
};

// Props íƒ€ì… : InferGetStaticPropsType ( SSRì˜ InferGetServerSidePropsType )
export default function Page({
  allBooks,
  recommendBooks,
}: InferGetStaticPropsType<typeof getStaticProps>) {
  return <></>;
}
```

### SSG ë°ì´í„° í˜¸ì¶œ + ì¿¼ë¦¬ìŠ¤íŠ¸ë§ ( GetStaticPropsContext )

> ë¹Œë“œ íƒ€ì„ì— ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— SSGëŠ” ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì„ ì•Œ ìˆ˜ ê°€ ì—†ë‹¤. ( âŒ context.query ) ( ğŸŸ¢ context.paramsëŠ” ëœë‹¤ )<br/>
> SSGì—ì„œ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì„ ê°€ì ¸ì™€ì„œ ë°ì´í„°ë¥¼ í˜ì¹­í•˜ë ¤ë©´ Reactì²˜ëŸ¼ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ useEffectë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.

```tsx
// GetStaticPropsContext ( SSRì˜ GetServerSidePropsContext )
export const getStaticProps = async (context: GetStaticPropsContext) => {
  // âŒ
  const query = context.query.q;
  if (!query) return;
  const books = await fetchBooks(query as string);

  return {
    props: { books },
  };
};

export default function Page({
  books,
}: InferGetStaticPropsType<typeof getStaticProps>) {
  return <></>;
}
```

---

### ë™ì  ê²½ë¡œì— SSG ì ìš© : getStaticPaths

> ë™ì  ê²½ë¡œ : [id].tsx

```tsx
// âŒ ë™ì  ê²½ë¡œ [id].tsxì—ëŠ” getStaticPropsë§Œ ì‚¬ìš©í•˜ë©´ ì•ˆë¨. ì¶”ê°€ë¡œ getStaticPaths ë©”ì†Œë“œë¥¼ ì¶”ê°€í•´ì•¼í•œë‹¤.
export const getStaticProps = async (context: GetStaticPropsContext) => {
  ...

  return {
    props: { data }
  }
}

export default function Page({ data }: InferGetStaticPropsType<typeof getStaticProps>) {
  return (
    <></>
  )
}
```

> ğŸ“Œ ì´ ë™ì  ê²½ë¡œ í˜ì´ì§€ì— ì¡´ì¬í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ê²½ë¡œë“¤ì„ ì§ì ‘ ì„¤ì •í•´ì¤˜ì•¼í•œë‹¤. ( getStaticPaths )

```tsx
// ğŸŸ¢ ë™ì  ê²½ë¡œ [id].tsxì—ëŠ” getStaticPaths ë©”ì†Œë“œë¥¼ ì¶”ê°€í•´ì•¼í•œë‹¤.
export const getStaticPaths = () => {
  return {
    // parameterëŠ” ë°˜ë“œì‹œ ë¬¸ìì—´
    paths: [
      { params: { id: "1" } },
      { params: { id: "2" } },
      { params: { id: "3" } },
    ],
    // ğŸ“Œ (ì˜ˆì™¸ìƒí™©) ëŒ€ì²´ 3ê°€ì§€
    /**
     * 1. fallback: false ( 404 í˜ì´ì§€ )
     * 2. fallback: 'blocking' ( SSRì²˜ëŸ¼ ì¦‰ì‹œ ìƒì„± )
     * 3. fallback: true ( ì¦‰ì‹œ ìƒì„± + í˜ì´ì§€ë§Œ ë¯¸ë¦¬ ë°˜í™˜ )
     */
    fallback: false
  }
}

export const getStaticProps = async (context: GetStaticPropsContext) => {
  ...
  return {
    props: { data }
  }
}

export default function Page({ data }: InferGetStaticPropsType<typeof getStaticProps>) {
  return (
    <></>
  )
}
```

### fallback: 'blocking'

```tsx
export const getStaticPaths = () => {
  return {
    paths: [
      { params: { id: "1" } },
      { params: { id: "2" } },
      { params: { id: "3" } },
    ],
    fallback: "blocking",
  };
};

// ğŸ“Œ getStaticPathsì— ì„¤ì •ë˜ì§€ ì•Šì€ URL íŒŒë¼ë¯¸í„°ëŠ” getStaticPropsì—ì„œ fetch í•´ì˜¨ë‹¤.
export const getStaticProps = async (context: GetStaticPropsContext) => {
  // ğŸ“Œ SSGì—ì„œ context.queryëŠ” ì•ˆë˜ê³  context.paramsëŠ” ëœë‹¤.
  const id = context.params!.id;
  const data = await fetchData(id);

  return {
    props: { data },
  };
};
```

### ì»´í¬ë„ŒíŠ¸ fallback ìƒíƒœ ì²´í¬

```tsx
export default function Page() {
  const router = useRouter();

  // fallback ì²´í¬
  if (router.isFallback) return "ë¡œë”©ì¤‘";
}
```

### getStaticPropsì—ì„œ ë°ì´í„° ì—†ì„ ë•Œ ì²˜ë¦¬ : notFound (?)

```tsx
export const getStaticProps = async (context: GestStaticPropsContext) => {
  const id = context.params!.id;
  const book = await fetchBook(id);

  // ğŸ“Œ notFound: true
  if (!book) {
    return {
      notFound: true,
    };
  }

  return {
    props: {
      book,
    },
  };
};
```
